function [P] = local_projection_4(X, Y, nodes, u, l, local_nodes)
  %local_stiffness Calculates the local projection vector for a given element
  % and its type, using an appropriate integration method.
  % NOTE: THIS IS GENERATED CODE. REFER TO local_projection.m.tmpl and generate.py
  if local_nodes == 4
    [P] = crunch_quad(X(1), X(2), X(3), X(4), ...
                      Y(1), Y(2), Y(3), Y(4), ...
                      nodes(1, 1), nodes(2, 1), nodes(3, 1), nodes(4, 1), ...
                      nodes(1, 2), nodes(2, 2), nodes(3, 2), nodes(4, 2), ...
                      u, l);
  elseif local_nodes == 8
    [P] = crunch_serindipity(X(1), X(2), X(3), X(4), ...
                           X(5), X(6), X(7), X(8), ...
                           Y(1), Y(2), Y(3), Y(4), ...
                           Y(5), Y(6), Y(7), Y(8), ...
                           nodes(1, 1), nodes(2, 1), nodes(3, 1), nodes(4, 1), ...
                           nodes(5, 1), nodes(6, 1), nodes(7, 1), nodes(8, 1), ...
                           nodes(1, 2), nodes(2, 2), nodes(3, 2), nodes(4, 2), ...
                           nodes(5, 2), nodes(6, 2), nodes(7, 2), nodes(8, 2), ...
                           u, l);
  else
    [P] = crunch_bubble(X(1), X(2), X(3), X(4), ...
                           X(5), X(6), X(7), X(8), X(9), ...
                           Y(1), Y(2), Y(3), Y(4), X(5), ...
                           Y(6), Y(7), Y(8), Y(9), ...
                           nodes(1, 1), nodes(2, 1), nodes(3, 1), nodes(4, 1), ...
                           nodes(5, 1), nodes(6, 1), nodes(7, 1), nodes(8, 1), nodes(9, 1), ...
                           nodes(1, 2), nodes(2, 2), nodes(3, 2), nodes(4, 2), ...
                           nodes(5, 2), nodes(6, 2), nodes(7, 2), nodes(8, 2), nodes(9, 2), ...
                           u, l);
  end
end

function [P] = crunch_quad(A, B, C, D, ...
                           R, S, T, U, ...
                           d0X, d1X, d2X, d3X, ...
                           d0Y, d1Y, d2Y, d3Y, ...
                           u, l)
  
    x0=sqrt(3);x1=x0 + 3;x2=D*x1;x3=3 - x0;x4=B*x3 ...
    ;x5=-A*x1 + C*x3;x6=x2 - x4 + x5;x7=x3*x6;x8=B*x1 ...
    ;x9=D*x3;x10=x5 + x8 - x9;x11=x1*x10;x12=x11 + x7;x13=d3Y* ...
    l;x14=l + 2*u;x15=U*x1;x16=S*x3;x17=-R*x1 + T*x3; ...
    x18=x15 - x16 + x17;x19=x1*x18;x20=-x19;x21=U*x3;x22=S*x1;x23= ...
    x17 - x21 + x22;x24=x1*x23;x25=x20 + x24;x26=d0X*x25;x27=x23*x3;x28 ...
    =x19 + x27;x29=d1X*x28;x30=x1*x6;x31=-x11;x32=x30 + x31;x33=d0Y*x32 ...
    ;x34=-x7;x35=x10*x3;x36=x34 + x35;x37=d2Y*l;x38=-x30;x39=-x35;x40 ...
    =x38 + x39;x41=d1Y*l;x42=x18*x3;x43=-x27;x44=x42 + x43;x45=d2X*x14 ...
    ;x46=-x42;x47=-x24;x48=x46 + x47;x49=d3X*x48;x50=l*x33 + x12*x13  ...
    + x14*x26 + x14*x29 + x14*x49 + x36*x37 + x40*x41 + x44*x45;x51 ...
    =x1^2;x52=-A*x3 + C*x1;x53=x52 - x8 + x9;x54=x3*x53;x55 ...
    =-x2 + x4 + x52;x56=x3*x55;x57=-x56;x58=x54 + x57;x59=d0Y*l; ...
    x60=-R*x3 + T*x1;x61=x21 - x22 + x60;x62=x3*x61;x63=-x15 + ...
     x16 + x60;x64=x1*x63;x65=x62 + x64;x66=d1X*x65;x67=-x54;x68=x1*x55 ...
    ;x69=-x68;x70=x67 + x69;x71=x1*x53;x72=x56 + x71;x73=-x71;x74=x68  ...
    + x73;x75=x1*x61;x76=-x64;x77=x75 + x76;x78=-x62;x79=x3*x63;x80=x78 ...
     + x79;x81=d0X*x80;x82=-x75;x83=-x79;x84=x82 + x83;x85=d3X*x84;x86= ...
    x13*x72 + x14*x66 + x14*x81 + x14*x85 + x37*x74 + x41*x70 + x45 ...
    *x77 + x58*x59;x87=x3^2;x88=x46 + x64;x89=d0X*x88;x90=x69 + x7; ...
    x91=x34 + x57;x92=x42 + x79;x93=d1X*x92;x94=x30 + x68;x95=x38 + x56 ...
    ;x96=x20 + x76;x97=d3X*x96;x98=x19 + x83;x99=x13*x94 + x14*x89 +  ...
    x14*x93 + x14*x97 + x37*x95 + x41*x91 + x45*x98 + x59*x90;x100=x1 ...
    *x3;x101=x27 + x82;x102=d0X*x101;x103=x39 + x71;x104=x31 + x73;x105=x24  ...
    + x75;x106=d1X*x105;x107=x35 + x54;x108=x11 + x67;x109=x47 + x62;x110=x43 ...
     + x78;x111=d3X*x110;x112=x102*x14 + x103*x59 + x104*x41 + x106*x14 +  ...
    x107*x13 + x108*x37 + x109*x45 + x111*x14;x113=x100*x112 + x100*x99;x114=d1Y ...
    *x14;x115=d2X*l;x116=d3Y*x14;x117=d2Y*x14;x118=l*x26 + l*x29 + l* ...
    x49 + x114*x40 + x115*x44 + x116*x12 + x117*x36 + x14*x33;x119=d0Y*x14 ...
    ;x120=l*x66 + l*x81 + l*x85 + x114*x70 + x115*x77 + x116*x72  ...
    + x117*x74 + x119*x58;x121=l*x102 + l*x106 + l*x111 + x103*x119 + ...
     x104*x114 + x107*x116 + x108*x117 + x109*x115;x122=l*x89 + l*x93 +  ...
    l*x97 + x114*x91 + x115*x98 + x116*x94 + x117*x95 + x119*x90;x123=x100 ...
    *x121 + x100*x122;x124=d0Y*u;x125=d0X*u;x126=d2Y*u;x127=d1Y*u;x128=d3X* ...
    u;x129=d2X*u;x130=d1X*u;x131=d3Y*u;x132=x12*x128 + x124*x25 + x125*x32 ...
     + x126*x44 + x127*x28 + x129*x36 + x130*x40 + x131*x48;x133=x124*x80  ...
    + x125*x58 + x126*x77 + x127*x65 + x128*x72 + x129*x74 + x130*x70 + ...
     x131*x84;x134=x124*x88 + x125*x90 + x126*x98 + x127*x92 + x128*x94 +  ...
    x129*x95 + x130*x91 + x131*x96;x135=x101*x124 + x103*x125 + x104*x130 + x105 ...
    *x127 + x107*x128 + x108*x129 + x109*x126 + x110*x131;x136=x100*x134 + x100* ...
    x135;x137=x100*x50 + x100*x86;x138=x100*x118 + x100*x120;x139=x100*x132 + x100*x133;
    P=[x113/5184 + x50*x51/5184 + x86*x87/5184, x118*x51/5184 + x120*x87/ ...
    5184 + x123/5184, x132*x51/5184 + x133*x87/5184 + x136/5184, x112*x51/5184 + ...
     x137/5184 + x87*x99/5184, x121*x51/5184 + x122*x87/5184 + x138/5184, x134* ...
    x87/5184 + x135*x51/5184 + x139/5184, x113/5184 + x50*x87/5184 + x51*x86/ ...
    5184, x118*x87/5184 + x120*x51/5184 + x123/5184, x132*x87/5184 + x133*x51/5184 ...
     + x136/5184, x112*x87/5184 + x137/5184 + x51*x99/5184, x121*x87/5184 +  ...
    x122*x51/5184 + x138/5184, x134*x51/5184 + x135*x87/5184 + x139/5184];
end

function [P] = crunch_serindipity(A, B, C, D, E, F, G, H, ...
                                  R, S, T, U, V, W, X, Y, ...
                                  d0X, d1X, d2X, d3X, d4X, d5X, d6X, d7X, ...
                                  d0Y, d1Y, d2Y, d3Y, d4Y, d5Y, d6Y, d7Y, ...
                                  u, l)
  
    x0=sqrt(3);x1=x0 + 3;x2=x1^2 - 4*x1;x3=3 - x0 ...
    ;x4=x0*x3;x5=F*x4;x6=x0*x1;x7=H*x6;x8=-3*x3;x9=-2*x4  ...
    + x8 + 6;x10=2*x6;x11=3*x0;x12=x11 + 3;x13=-x10 + x12; ...
    x14=-3*x1;x15=x14 - 2*x6 + 6;x16=2*x4;x17=3 - x11;x18=- ...
    x16 + x17;x19=A*x15 + C*x18;x20=12*G;x21=-12*E + x20;x22=B ...
    *x9 + D*x13 + x19 + x21 + 4*x5 + 4*x7;x23=E*x6;x24= ...
    3*F - 3*H;x25=4*G;x26=x25*x4;x27=B*x13 + D*x9 + x19 ...
     + 4*x23 + 4*x24 + x26;x28=-x15*x22 + x15*x27;x29=d0Y*x28;x30 ...
    =3*x27;x31=-x22*x4 + x30;x32=4*l;x33=d6Y*x32;x34=-x13*x22 +  ...
    x27*x9;x35=d1Y*x34;x36=Y*x6;x37=W*x4;x38=3*X;x39=-3*V + x38 ...
    ;x40=R*x15 + T*x18;x41=S*x9 + U*x13 + 4*x36 + 4*x37  ...
    + 4*x39 + x40;x42=V*x6;x43=X*x4;x44=-3*Y;x45=3*W;x46=x44 ...
     + x45;x47=S*x13 + U*x9 + x40 + 4*x42 + 4*x43 + 4* ...
    x46;x48=3*x47;x49=x4*x41 - x48;x50=l + 2*u;x51=4*x50;x52=d6X ...
    *x51;x53=x13*x41 - x47*x9;x54=d1X*x53;x55=x15*x41 - x15*x47;x56=d0X* ...
    x50;x57=3*x22;x58=x27*x4 - x57;x59=d5Y*x32;x60=x18*x41 - x18*x47;x61 ...
    =d2X*x60;x62=3*x41;x63=-x4*x47 + x62;x64=d5X*x63;x65=-x22*x6 -  ...
    x30;x66=d4Y*x65;x67=x13*x27 - x22*x9;x68=d3Y*x67;x69=x41*x6 + x48;x70 ...
    =d4X*x51;x71=-x18*x22 + x18*x27;x72=d2Y*x71;x73=-x13*x47 + x41*x9; ...
    x74=d3X*x73;x75=-x47*x6 - x62;x76=d7X*x75;x77=x27*x6 + x57;x78=d7Y* ...
    x32;x79=l*x29 + l*x35 + l*x68 + l*x72 + x31*x33 + x32*x66 ...
     + x49*x52 + x50*x54 + x50*x61 + x50*x74 + x51*x64 + x51*x76  ...
    + x55*x56 + x58*x59 + x69*x70 + x77*x78;x80=x3^2 - 4*x3;x81 ...
    =F*x6;x82=H*x4;x83=x16 + x17;x84=x14 + 2*x6 + 6;x85=x10  ...
    + x12;x86=2*x4 + x8 + 6;x87=A*x86 + C*x85;x88=B*x84 + ...
     D*x83 - 12*E + x20 - 4*x81 - 4*x82 + x87;x89=-12*H; ...
    x90=x25*x6;x91=E*x4;x92=B*x83 + D*x84 + 12*F + x87 + x89 ...
     - x90 - 4*x91;x93=3*x92;x94=x6*x88 + x93;x95=x4*x88 - x93; ...
    x96=d4Y*x32;x97=x83*x92 - x84*x88;x98=d3Y*x97;x99=W*x6;x100=Y*x4;x101 ...
    =-12*V;x102=R*x86 + T*x85;x103=S*x84 + U*x83 - 4*x100 +  ...
    x101 + x102 + 4*x38 - 4*x99;x104=3*x103;x105=V*x4;x106=X*x6;x107 ...
    =S*x83 + U*x84 + x102 - 4*x105 - 4*x106 + 4*x46;x108=x104  ...
    + x107*x6;x109=d5X*x108;x110=3*x88;x111=x110 - x4*x92;x112=-x110 - x6* ...
    x92;x113=x103*x85 - x107*x85;x114=d2X*x113;x115=-x104 + x107*x4;x116=d7X*x115; ...
    x117=-x85*x88 + x85*x92;x118=d2Y*x117;x119=x103*x84 - x107*x83;x120=d3X*x119; ...
    x121=-x86*x88 + x86*x92;x122=d0Y*x121;x123=3*x107;x124=-x103*x6 - x123;x125 ...
    =x103*x83 - x107*x84;x126=d1X*x125;x127=-x83*x88 + x84*x92;x128=d1Y*x127;x129 ...
    =-x103*x4 + x123;x130=x103*x86 - x107*x86;x131=d0X*x130;x132=l*x118 + l ...
    *x122 + l*x128 + l*x98 + x109*x51 + x111*x78 + x112*x59 + x114* ...
    x50 + x116*x51 + x120*x50 + x124*x52 + x126*x50 + x129*x70 + x131*x50 ...
     + x33*x94 + x95*x96;x133=A*x84 + C*x83;x134=B*x86 + D*x85  ...
    + x133 + x21 - 4*x5 - 4*x7;x135=A*x9 + C*x13;x136=B*x18 ...
     + D*x15 + 12*F + x135 + x89 + x90 + 4*x91;x137=3*x136; ...
    x138=-x134*x6 + x137;x139=R*x84 + T*x83;x140=S*x86 + U*x85 +  ...
    x139 - 4*x36 - 4*x37 + 4*x39;x141=R*x9 + T*x13;x142=S*x18 ...
     + U*x15 + 12*W + 4*x105 + 4*x106 + x141 + 4*x44;x143= ...
    x13*x140 - x142*x83;x144=d2X*x143;x145=3*x134;x146=-x136*x4 - x145;x147=-x136 ...
    *x6 + x145;x148=3*x142;x149=x140*x6 - x148;x150=d6X*x149;x151=x140*x18 -  ...
    x142*x86;x152=d1X*x151;x153=x140*x4 + x148;x154=d4X*x153;x155=3*x140;x156=x142*x6 ...
     - x155;x157=d7X*x156;x158=-x134*x18 + x136*x86;x159=d1Y*l;x160=x140*x9 - ...
     x142*x84;x161=-x134*x15 + x136*x85;x162=d3Y*x161;x163=-x13*x134 + x136*x83; ...
    x164=d2Y*x163;x165=-x134*x9 + x136*x84;x166=d0Y*x165;x167=x142*x4 + x155;x168= ...
    d5X*x167;x169=x140*x15 - x142*x85;x170=d3X*x50;x171=-x134*x4 - x137;x172=d4Y* ...
    x171;x173=l*x162 + l*x164 + l*x166 + x138*x33 + x144*x50 + x146*x59 ...
     + x147*x78 + x150*x51 + x152*x50 + x154*x51 + x157*x51 + x158*x159  ...
    + x160*x56 + x168*x51 + x169*x170 + x172*x32;x174=x1*x3 - 12;x175=S ...
    *x15 + U*x18 + 4*x100 + x101 + x141 + 4*x38 + 4*x99;x176= ...
    S*x85 + U*x86 - 12*Y + x139 - 4*x42 - 4*x43 + 4*x45 ...
    ;x177=3*x176;x178=-x175*x6 + x177;x179=-x15*x176 + x175*x85;x180=d1X*x179; ...
    x181=-x13*x176 + x175*x83;x182=d2X*x181;x183=B*x15 + D*x18 + x135 +  ...
    x21 + 4*x81 + 4*x82;x184=B*x85 + D*x86 + x133 - 4*x23 + ...
     4*x24 - x26;x185=3*x184;x186=x183*x4 + x185;x187=-x183*x84 + x184*x9 ...
    ;x188=d0Y*x187;x189=3*x175;x190=-x176*x4 - x189;x191=d7X*x190;x192=-x176*x6  ...
    + x189;x193=d5X*x192;x194=x175*x84 - x176*x9;x195=x175*x86 - x176*x18;x196=x15 ...
    *x184 - x183*x85;x197=x183*x6 - x185;x198=x13*x184 - x183*x83;x199=d2Y*x198; ...
    x200=3*x183;x201=x184*x4 + x200;x202=x184*x6 - x200;x203=x18*x184 - x183*x86 ...
    ;x204=d3Y*x203;x205=-x175*x4 - x177;x206=l*x188 + l*x199 + l*x204 + ...
     x159*x196 + x170*x195 + x178*x70 + x180*x50 + x182*x50 + x186*x33 +  ...
    x191*x51 + x193*x51 + x194*x56 + x197*x96 + x201*x78 + x202*x59 + x205 ...
    *x52;x207=x173*x174 + x174*x206;x208=d6Y*x51;x209=d0X*l;x210=d5Y*x51;x211=d4X* ...
    x32;x212=d7Y*x51;x213=d6X*x32;x214=l*x54 + l*x61 + l*x74 + x208*x31 ...
     + x209*x55 + x210*x58 + x211*x69 + x212*x77 + x213*x49 + x29*x50  ...
    + x32*x64 + x32*x76 + x35*x50 + x50*x68 + x50*x72 + x51*x66;x215 ...
    =d4Y*x51;x216=l*x114 + l*x120 + l*x126 + l*x131 + x109*x32 +  ...
    x111*x212 + x112*x210 + x116*x32 + x118*x50 + x122*x50 + x124*x213 + x128 ...
    *x50 + x129*x211 + x208*x94 + x215*x95 + x50*x98;x217=d1Y*x50;x218=d3X* ...
    l;x219=l*x180 + l*x182 + x178*x211 + x186*x208 + x188*x50 + x191*x32 ...
     + x193*x32 + x194*x209 + x195*x218 + x196*x217 + x197*x215 + x199*x50  ...
    + x201*x212 + x202*x210 + x204*x50 + x205*x213;x220=l*x144 + l*x152 + ...
     4*l*x154 + x138*x208 + x146*x210 + x147*x212 + x150*x32 + x157*x32  ...
    + x158*x217 + x160*x209 + x162*x50 + x164*x50 + x166*x50 + x168*x32 + ...
     x169*x218 + 4*x172*x50;x221=x174*x219 + x174*x220;x222=4*u;x223=d4Y*x222; ...
    x224=d5Y*x222;x225=d1Y*u;x226=d2X*u;x227=d7Y*x222;x228=d7X*x222;x229=d3X*u;x230 ...
    =d0X*u;x231=d3Y*u;x232=d6X*x222;x233=d2Y*u;x234=d5X*x222;x235=d1X*u;x236= ...
    d0Y*u;x237=d6Y*x222;x238=d4X*x222;x239=x223*x69 + x224*x63 + x225*x53 + x226 ...
    *x71 + x227*x75 + x228*x77 + x229*x67 + x230*x28 + x231*x73 + x232* ...
    x31 + x233*x60 + x234*x58 + x235*x34 + x236*x55 + x237*x49 + x238*x65 ...
    ;x240=x108*x224 + x111*x228 + x112*x234 + x113*x233 + x115*x227 + x117*x226  ...
    + x119*x231 + x121*x230 + x124*x237 + x125*x225 + x127*x235 + x129*x223 + ...
     x130*x236 + x229*x97 + x232*x94 + x238*x95;x241=x138*x232 + x143*x233 +  ...
    x146*x234 + x147*x228 + x149*x237 + x151*x225 + x153*x223 + x156*x227 + x158 ...
    *x235 + x160*x236 + x161*x229 + x163*x226 + x165*x230 + x167*x224 + x169* ...
    x231 + x171*x238;x242=x178*x223 + x179*x225 + x181*x233 + x186*x232 + x187*x230 ...
     + x190*x227 + x192*x224 + x194*x236 + x195*x231 + x196*x235 + x197*x238  ...
    + x198*x226 + x201*x228 + x202*x234 + x203*x229 + x205*x237;x243=x174*x241 + ...
     x174*x242;x244=x132*x174 + x174*x79;x245=x174*x214 + x174*x216;x246=x174*x239 +  ...
    x174*x240;x247=x1*x206 + x173*x3;x248=x1*x79 + x132*x3;x249=x1*x219 + x220 ...
    *x3;x250=x1*x214 + x216*x3;x251=x1*x242 + x241*x3;x252=x1*x239 + x240* ...
    x3;x253=x1*x132 + x3*x79;x254=x1*x216 + x214*x3;x255=x1*x240 + x239*x3 ...
    ;x256=x1*x173 + x206*x3;x257=x1*x220 + x219*x3;x258=x1*x241 + x242*x3;
    P=[x132*x80/46656 + x2*x79/46656 + x207/46656, x2*x214/46656 + x216*x80/ ...
    46656 + x221/46656, x2*x239/46656 + x240*x80/46656 + x243/46656, x173*x80/46656 + ...
     x2*x206/46656 + x244/46656, x2*x219/46656 + x220*x80/46656 + x245/46656, x2* ...
    x242/46656 + x241*x80/46656 + x246/46656, x132*x2/46656 + x207/46656 + x79*x80/ ...
    46656, x2*x216/46656 + x214*x80/46656 + x221/46656, x2*x240/46656 + x239*x80/46656 ...
     + x243/46656, x173*x2/46656 + x206*x80/46656 + x244/46656, x2*x220/46656 +  ...
    x219*x80/46656 + x245/46656, x2*x241/46656 + x242*x80/46656 + x246/46656, x247/11664 ...
     + x248/11664, x249/11664 + x250/11664, x251/11664 + x252/11664, x247/11664 + x253 ...
    /11664, x249/11664 + x254/11664, x251/11664 + x255/11664, x253/11664 + x256/11664,  ...
    x254/11664 + x257/11664, x255/11664 + x258/11664, x248/11664 + x256/11664, x250/11664  ...
    + x257/11664, x252/11664 + x258/11664];
end

function [P] = crunch_bubble(A, B, C, D, E, F, G, H, I, ...
                             R, S, T, U, V, W, X, Y, Z, ...
                             d0X, d1X, d2X, d3X, d4X, d5X, d6X, d7X, d8X, ...
                             d0Y, d1Y, d2Y, d3Y, d4Y, d5Y, d6Y, d7Y, d8Y, ...
                             u, l)
  
    x0=sqrt(3);x1=x0 + 3;x2=2*x1;x3=x1^2 - 2*x2 + ...
     6;x4=-x0;x5=x4 - 3;x6=E*x5;x7=2*x0;x8=I*x7;x9=x4 ...
     + 3;x10=x0*x9;x11=x10 + x4;x12=x0*x1;x13=x12 + x4;x14=G* ...
    x9;x15=x0*x2;x16=9*x0;x17=-x15 + x16 + 3;x18=-x10;x19=3*x0 ...
    ;x20=x19 + 3;x21=-3*x9;x22=2*x18 + 2*x20 + x21;x23=2*x9; ...
    x24=x0*x23;x25=x20 - x24;x26=-x12;x27=-3*x1;x28=2*x20 + 2*x26  ...
    + x27;x29=A*x28 + C*x25;x30=B*x22 + D*x17 + 4*F*x11 + ...
     4*H*x13 + 4*x14 + x29 + 4*x6 + 4*x8;x31=F*x9;x32= ...
    H*x5;x33=4*E;x34=B*x17 + D*x22 + 4*G*x11 + x13*x33 + ...
     x29 + 4*x31 + 4*x32 + 4*x8;x35=-8*x0*x30 + 8*x0*x34; ...
    x36=d8Y*x35;x37=-x17*x30 + x22*x34;x38=d1Y*x37;x39=4*V*x5;x40=Z* ...
    x7;x41=X*x9 + x40;x42=4*W;x43=R*x28 + T*x25;x44=S*x22 + ...
     U*x17 + 4*Y*x13 + x11*x42 + x39 + 4*x41 + x43;x45=x42* ...
    x9;x46=Y*x5 + x40;x47=S*x17 + U*x22 + 4*V*x13 + 4*X ...
    *x11 + x43 + x45 + 4*x46;x48=x25*x44 - x25*x47;x49=2*u;x50= ...
    l + x49;x51=d2X*x50;x52=-x25*x30 + x25*x34;x53=d2Y*x52;x54=x13*x34  ...
    - x30*x5;x55=4*l;x56=d7Y*x55;x57=4*x50;x58=x11*x44 - x47*x9;x59 ...
    =d6X*x58;x60=-x11*x30 + x34*x9;x61=d6Y*x55;x62=x11*x34 - x30*x9;x63 ...
    =d5Y*x62;x64=-x13*x47 + x44*x5;x65=d7X*x64;x66=x28*x44 - x28*x47;x67 ...
    =d0X*x66;x68=-x28*x30 + x28*x34;x69=d0Y*x68;x70=-x11*x47 + x44*x9; ...
    x71=d5X*x70;x72=2*x50;x73=x13*x44 - x47*x5;x74=d4X*x73;x75=x17*x44 - ...
     x22*x47;x76=d1X*x75;x77=-x17*x47 + x22*x44;x78=d3X*x77;x79=d8X*x50;x80 ...
    =8*x0*x44 - 8*x0*x47;x81=-x13*x30 + x34*x5;x82=d4Y*x81;x83=x17 ...
    *x34 - x22*x30;x84=d3Y*x83;x85=l*x36 + l*x38 + l*x53 + l* ...
    x69 + l*x84 + x48*x51 + x50*x67 + x50*x76 + x50*x78 + x54*x56 ...
     + x55*x63 + x55*x82 + x57*x59 + x57*x65 + x60*x61 + 2*x71* ...
    x72 + 2*x72*x74 + x79*x80;x86=-2*x23 + x9^2 + 6;x87=x0 - ...
     3;x88=x0 + x18;x89=G*x1;x90=x0 + x26;x91=-x16 + x24 + 3 ...
    ;x92=E*x87;x93=3 - x19;x94=2*x12 + x27 + 2*x93;x95=x15 +  ...
    x93;x96=8*x0;x97=I*x96;x98=2*x10 + x21 + 2*x93;x99=A*x98 + ...
     C*x95 - x97;x100=B*x94 + D*x91 + 4*F*x90 + 4*H*x88  ...
    + 4*x89 + 4*x92 + x99;x101=F*x1 + H*x87;x102=B*x91 + D ...
    *x94 + 4*G*x90 + 4*x101 + x33*x88 + x99;x103=-x100*x87 + x102 ...
    *x88;x104=x1*x102 - x100*x90;x105=-x100*x94 + x102*x91;x106=d3Y*x105;x107=V ...
    *x87;x108=X*x1;x109=-x40;x110=R*x98 + T*x95;x111=S*x94 + U*x91 ...
     + 4*W*x90 + 4*Y*x88 + 4*x107 + 4*x108 + 4*x109 +  ...
    x110;x112=Y*x87;x113=W*x1;x114=S*x91 + U*x94 + 4*V*x88 + 4 ...
    *X*x90 + 4*x109 + x110 + 4*x112 + 4*x113;x115=x111*x87 - x114* ...
    x88;x116=d7X*x57;x117=x111*x95 - x114*x95;x118=-x100*x95 + x102*x95;x119=d2Y* ...
    x118;x120=8*x0*x100 - 8*x0*x102;x121=d8Y*x120;x122=-x100*x98 + x102*x98; ...
    x123=d0Y*x122;x124=-8*x0*x111 + 8*x0*x114;x125=x111*x91 - x114*x94;x126=d1X ...
    *x125;x127=x111*x94 - x114*x91;x128=d3X*x127;x129=x111*x98 - x114*x98;x130=d0X* ...
    x129;x131=x1*x111 - x114*x90;x132=d5X*x131;x133=-x1*x114 + x111*x90;x134=d6X* ...
    x57;x135=-x1*x100 + x102*x90;x136=d5Y*x135;x137=x111*x88 - x114*x87;x138=d4X* ...
    x137;x139=-x100*x88 + x102*x87;x140=d4Y*x139;x141=-x100*x91 + x102*x94;x142=d1Y ...
    *x141;x143=l*x106 + l*x119 + l*x121 + l*x123 + l*x142 + x103* ...
    x56 + x104*x61 + x115*x116 + x117*x51 + x124*x79 + x126*x50 + x128*x50 ...
     + x130*x50 + x132*x57 + x133*x134 + x136*x55 + x138*x57 + x140*x55; ...
    x144=4*x88;x145=R*x94 + T*x91;x146=S*x98 + U*x95 + W*x144 + ...
     4*Y*x90 + 4*x107 + 4*x108 + 4*x109 + x145;x147=R*x22 +  ...
    T*x17;x148=S*x25 + U*x28 + 4*V*x11 + 4*X*x13 + x147 + ...
     x45 + 4*x46;x149=x146*x9 - x148*x88;x150=d5X*x149;x151=-x8;x152=A*x94 ...
     + C*x91;x153=B*x98 + D*x95 + 4*F*x88 + 4*H*x90 +  ...
    4*x151 + x152 + 4*x89 + 4*x92;x154=4*x13;x155=A*x22 + C*x17 ...
     + x97;x156=B*x25 + D*x28 + G*x154 + x11*x33 + x155 + 4* ...
    x31 + 4*x32;x157=-x153*x5 + x156*x90;x158=d7Y*x157;x159=-x153*x28 + x156 ...
    *x95;x160=d3Y*x159;x161=x1*x156 - x13*x153;x162=x146*x22 - x148*x94;x163=d0X* ...
    x162;x164=-x153*x9 + x156*x88;x165=d5Y*x164;x166=x146*x25 - x148*x98;x167=d1X* ...
    x166;x168=x146*x5 - x148*x90;x169=d7X*x168;x170=-8*x0*x153 - 8*x0*x156;x171 ...
    =d8Y*l;x172=-x153*x22 + x156*x94;x173=d0Y*x172;x174=x146*x17 - x148*x91;x175 ...
    =-x153*x25 + x156*x98;x176=d1Y*x175;x177=-x11*x153 + x156*x87;x178=d4Y*x177; ...
    x179=8*x0*x146 + 8*x0*x148;x180=-x153*x17 + x156*x91;x181=d2Y*x180;x182= ...
    -x1*x148 + x13*x146;x183=x146*x28 - x148*x95;x184=d3X*x183;x185=x11*x146 -  ...
    x148*x87;x186=d4X*x185;x187=l*x160 + l*x173 + l*x176 + l*x181 + x134 ...
    *x182 + x150*x57 + x158*x55 + x161*x61 + x163*x50 + x165*x55 + x167* ...
    x50 + x169*x57 + x170*x171 + x174*x51 + x178*x55 + x179*x79 + x184*x50 ...
     + x186*x57;x188=x1*x9 - 6;x189=B*x28 + D*x25 + 4*F*x13  ...
    + 4*H*x11 + 4*x14 + x155 + 4*x6;x190=B*x95 + D*x98 + ...
     4*G*x88 + 4*x101 + 4*x151 + x152 + x33*x90;x191=x17*x190 -  ...
    x189*x91;x192=d2Y*x191;x193=S*x28 + U*x25 + W*x154 + 4*Y*x11 + ...
     x147 + x39 + 4*x41;x194=S*x95 + U*x98 + 4*V*x90 + X* ...
    x144 - Z*x96 + 4*x112 + 4*x113 + x145;x195=x193*x90 - x194*x5;x196 ...
    =d4X*x195;x197=-8*x0*x193 - 8*x0*x194;x198=d8X*x197;x199=-x189*x98 + x190 ...
    *x25;x200=d3Y*x199;x201=-x189*x94 + x190*x22;x202=d0Y*x201;x203=-x189*x90 +  ...
    x190*x5;x204=d4Y*x203;x205=-x1*x189 + x13*x190;x206=d5Y*x205;x207=x11*x190 -  ...
    x189*x87;x208=-x11*x194 + x193*x87;x209=-x189*x88 + x190*x9;x210=-x17*x194  ...
    + x193*x91;x211=x193*x95 - x194*x28;x212=d1X*x211;x213=x193*x88 - x194*x9;x214 ...
    =d6X*x213;x215=8*x0*x189 + 8*x0*x190;x216=x193*x98 - x194*x25;x217=d3X* ...
    x216;x218=-x189*x95 + x190*x28;x219=d1Y*x218;x220=x1*x193 - x13*x194;x221=d5X* ...
    x220;x222=x193*x94 - x194*x22;x223=d0X*x222;x224=l*x192 + l*x200 + l*x202 ...
     + l*x219 + x116*x208 + x171*x215 + x196*x57 + x198*x50 + x204*x55  ...
    + x206*x55 + x207*x56 + x209*x61 + x210*x51 + x212*x50 + x214*x57 + ...
     x217*x50 + x221*x57 + x223*x50;x225=x187*x188 + x188*x224;x226=d2X*l;x227= ...
    d8X*l;x228=d7Y*x57;x229=d6Y*x57;x230=l*x67 + l*x76 + l*x78 + x226 ...
    *x48 + x227*x80 + x228*x54 + x229*x60 + x36*x50 + x38*x50 + x50* ...
    x53 + x50*x69 + x50*x84 + x55*x59 + x55*x65 + x55*x71 + x55*x74 ...
     + x57*x63 + x57*x82;x231=d6X*x55;x232=d7X*x55;x233=l*x126 + l*x128  ...
    + l*x130 + x103*x228 + x104*x229 + x106*x50 + x115*x232 + x117*x226 + ...
     x119*x50 + x121*x50 + x123*x50 + x124*x227 + x132*x55 + x133*x231 +  ...
    x136*x57 + x138*x55 + x140*x57 + x142*x50;x234=d8Y*x50;x235=l*x163 + l ...
    *x167 + l*x184 + x150*x55 + x158*x57 + x160*x50 + x161*x229 + x165* ...
    x57 + x169*x55 + x170*x234 + x173*x50 + x174*x226 + x176*x50 + x178*x57 ...
     + x179*x227 + x181*x50 + x182*x231 + x186*x55;x236=l*x198 + l*x212  ...
    + l*x217 + l*x223 + x192*x50 + x196*x55 + x200*x50 + x202*x50 + ...
     x204*x57 + x206*x57 + x207*x228 + x208*x232 + x209*x229 + x210*x226 +  ...
    x214*x55 + x215*x234 + x219*x50 + x221*x55;x237=x188*x235 + x188*x236;x238=4 ...
    *u;x239=d7Y*x238;x240=d3Y*u;x241=d4Y*x238;x242=d0X*u;x243=d6X*x238;x244=d8X* ...
    u;x245=d4X*x238;x246=d7X*x238;x247=d1Y*u;x248=d0Y*u;x249=d2X*u;x250=d6Y*x238 ...
    ;x251=d5X*x238;x252=d2Y*u;x253=d8Y*u;x254=d5Y*x238;x255=d1X*u;x256=d3X*u; ...
    x257=x239*x64 + x240*x77 + x241*x73 + x242*x68 + x243*x60 + x244*x35 + ...
     x245*x81 + x246*x54 + x247*x75 + x248*x66 + x249*x52 + x250*x58 +  ...
    x251*x62 + x252*x48 + x253*x80 + x254*x70 + x255*x37 + x256*x83;x258=d5X ...
    *x49;x259=d4X*x49;x260=x103*x246 + x104*x243 + x105*x256 + x115*x239 + x117* ...
    x252 + x118*x249 + x120*x244 + x122*x242 + x124*x253 + x125*x247 + x127*x240 ...
     + x129*x248 + x131*x254 + x133*x250 + 2*x135*x258 + x137*x241 + 2* ...
    x139*x259 + x141*x255;x261=x149*x254 + x157*x246 + x159*x256 + x161*x243 + x162 ...
    *x248 + 2*x164*x258 + x166*x247 + x168*x239 + x170*x244 + x172*x242 +  ...
    x174*x252 + x175*x255 + 2*x177*x259 + x179*x253 + x180*x249 + x182*x250 + ...
     x183*x240 + x185*x241;x262=x191*x249 + x195*x241 + x197*x253 + x199*x256 +  ...
    x201*x242 + x203*x245 + x205*x251 + x207*x246 + x208*x239 + x209*x243 + x210 ...
    *x252 + x211*x247 + x213*x250 + x215*x244 + x216*x240 + x218*x255 + x220* ...
    x254 + x222*x248;x263=x188*x261 + x188*x262;x264=x143*x188 + x188*x85;x265=x188*x230 ...
     + x188*x233;x266=x188*x257 + x188*x260;x267=x0 + 2;x268=x4 + 2;x269= ...
    x143*x268 + x267*x85;x270=x187*x268 + x224*x267;x271=x235*x268 + x236*x267;x272=x230 ...
    *x267 + x233*x268;x273=x261*x268 + x262*x267;x274=x257*x267 + x260*x268;x275=x143* ...
    x267 + x268*x85;x276=x230*x268 + x233*x267;x277=x257*x268 + x260*x267;x278=x187*x267 ...
     + x224*x268;x279=x235*x267 + x236*x268;x280=x261*x267 + x262*x268;
    P=[x143*x86/46656 + x225/46656 + x3*x85/46656, x230*x3/46656 + x233*x86/ ...
    46656 + x237/46656, x257*x3/46656 + x260*x86/46656 + x263/46656, x187*x86/46656 + ...
     x224*x3/46656 + x264/46656, x235*x86/46656 + x236*x3/46656 + x265/46656, x261* ...
    x86/46656 + x262*x3/46656 + x266/46656, x143*x3/46656 + x225/46656 + x85*x86/ ...
    46656, x230*x86/46656 + x233*x3/46656 + x237/46656, x257*x86/46656 + x260*x3/46656 ...
     + x263/46656, x187*x3/46656 + x224*x86/46656 + x264/46656, x235*x3/46656 +  ...
    x236*x86/46656 + x265/46656, x261*x3/46656 + x262*x86/46656 + x266/46656, x269/11664 ...
     + x270/11664, x271/11664 + x272/11664, x273/11664 + x274/11664, x270/11664 + x275 ...
    /11664, x271/11664 + x276/11664, x273/11664 + x277/11664, x275/11664 + x278/11664,  ...
    x276/11664 + x279/11664, x277/11664 + x280/11664, x269/11664 + x278/11664, x272/11664  ...
    + x279/11664, x274/11664 + x280/11664, x143/5832 + x187/5832 + x224/5832 + x85 ...
    /5832, x230/5832 + x233/5832 + x235/5832 + x236/5832, x257/5832 + x260/5832  ...
    + x261/5832 + x262/5832];
end

